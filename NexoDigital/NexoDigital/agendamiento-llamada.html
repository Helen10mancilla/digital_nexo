<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nexo Digital - Agendar Llamada</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
</head>

<body>
    <!-- Header / Navegación común -->
    <header class="header">
        <nav class="nav container">
            <div class="nav__logo">
                <a href="index.html" class="logo">NEXO DIGITAL</a>
            </div>

            <div class="nav__menu" id="nav-menu">
                <ul class="nav__list">
                    <li class="nav__item"><a href="index.html" class="nav__link">Inicio</a></li>
                    <li class="nav__item"><a href="quienes-somos.html" class="nav__link">Nosotros</a></li>
                    <li class="nav__item"><a href="servicios.html" class="nav__link">Servicios</a></li>
                    <li class="nav__item"><a href="proceso.html" class="nav__link">Proceso</a></li>
                    <li class="nav__item"><a href="proyectos.html" class="nav__link">Proyectos</a></li>
                    <li class="nav__item"><a href="planes.html" class="nav__link">Planes</a></li>
                    <li class="nav__item"><a href="contacto.html" class="nav__link">Contacto</a></li>
                </ul>

                <div class="nav__close" id="nav-close">
                    <i class="fas fa-times"></i>
                </div>
            </div>

            <div class="nav__toggle" id="nav-toggle">
                <i class="fas fa-bars"></i>
            </div>
        </nav>
    </header>

    <main>
        <!-- Hero Section -->
        <section class="hero-mini section">
            <div class="container">
                <div class="hero__content text-center">
                    <h1 class="hero__title">Agenda tu <span class="highlight">Llamada Técnica</span></h1>
                    <p class="hero__description">Selecciona el mejor horario para discutir tu proyecto con nuestros
                        ingenieros senior.</p>
                </div>
            </div>
        </section>

        <!-- Scheduling Form Section -->
        <section class="scheduling section">
            <div class="container">
                <div class="form-wrapper card animate-on-scroll">
                    <div class="form-header">
                        <h3>Detalles de la Reunión</h3>
                        <p>Completa el formulario para reservar tu sesión técnica de 30 minutos.</p>
                    </div>

                    <form id="appointmentForm" class="appointment-form">
                        <div class="form-grid">
                            <!-- User Info -->
                            <div class="form-group">
                                <label for="fullName">Nombre Completo *</label>
                                <input type="text" id="fullName" name="fullName" placeholder="Juan Pérez" required>
                            </div>

                            <div class="form-group">
                                <label for="email">Correo Electrónico *</label>
                                <input type="email" id="email" name="email" placeholder="juan@empresa.com" required>
                            </div>

                            <div class="form-group">
                                <label for="phone">Teléfono de Contacto (WhatsApp) *</label>
                                <input type="tel" id="phone" name="phone" placeholder="+57 300 123 4567" required>
                            </div>

                            <div class="form-group">
                                <label for="company">Empresa</label>
                                <input type="text" id="company" name="company" placeholder="Nombre de tu empresa">
                            </div>

                            <div class="form-group">
                                <label for="service">Servicio de Interés</label>
                                <select id="service" name="service">
                                    <option value="saas">SaaS Development</option>
                                    <option value="web">Custom Web Development</option>
                                    <option value="ux">UX/UI Design</option>
                                    <option value="mobile">Mobile App Development</option>
                                    <option value="integration">Integraciones</option>
                                    <option value="consulting">Consultoría Técnica</option>
                                </select>
                            </div>

                            <!-- Schedule Info -->
                            <div class="form-group">
                                <label for="date">Fecha de la Llamada *</label>
                                <input type="date" id="date" name="date" required>
                            </div>

                            <div class="form-group">
                                <label for="time">Hora (Zona horaria local) *</label>
                                <select id="time" name="time" required>
                                    <option value="">Selecciona una hora</option>
                                    <option value="09:00">09:00 AM</option>
                                    <option value="10:00">10:00 AM</option>
                                    <option value="11:00">11:00 AM</option>
                                    <option value="14:00">02:00 PM</option>
                                    <option value="15:00">03:00 PM</option>
                                    <option value="16:00">04:00 PM</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="notes">Temas a Tratar</label>
                            <textarea id="notes" name="notes" rows="4"
                                placeholder="¿Qué te gustaría discutir específicamente?"></textarea>
                        </div>

                        <div class="form-actions">
                            <button type="submit" class="btn btn--primary btn--block">
                                <span class="btn-text">Confirmar Agendamiento</span>
                                <i class="fas fa-calendar-check"></i>
                            </button>
                            <a href="contacto.html" class="btn-back">
                                <i class="fas fa-arrow-left"></i> Volver a contacto
                            </a>
                        </div>
                    </form>

                    <!-- Success Message (initially hidden) -->
                    <div id="successMessage" class="success-overlay" style="display: none;">
                        <div class="success-content">
                            <div class="success-icon">
                                <i class="fas fa-check-circle"></i>
                            </div>
                            <h3>¡Agendamiento Exitoso!</h3>
                            <p>Tu llamada técnica ha sido reservada correctamente. Hemos guardado los detalles en
                                nuestro sistema y te contactaremos pronto.</p>
                            <div class="appointment-summary" id="appointmentSummary">
                                <!-- Details will be injected here -->
                            </div>
                            <a href="index.html" class="btn btn--primary">Volver al Inicio</a>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer común -->
    <footer class="footer">
        <div class="container">
            <div class="footer__bottom text-center">
                <p class="footer__copyright">© 2024 Nexo Digital. Todos los derechos reservados.</p>
            </div>
        </div>
    </footer>

    <script src="main.js"></script>
    <script src="db.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const form = document.getElementById('appointmentForm');
            const successOverlay = document.getElementById('successMessage');
            const summaryDiv = document.getElementById('appointmentSummary');

            // Set min date to today
            const dateInput = document.getElementById('date');
            const today = new Date().toISOString().split('T')[0];
            dateInput.setAttribute('min', today);

            if (form) {
                form.addEventListener('submit', function (e) {
                    e.preventDefault();

                    const submitBtn = form.querySelector('button[type="submit"]');
                    const btnText = submitBtn.querySelector('.btn-text');

                    // Collect data
                    const formData = {
                        fullName: document.getElementById('fullName').value,
                        email: document.getElementById('email').value,
                        phone: document.getElementById('phone').value,
                        company: document.getElementById('company').value,
                        service: document.getElementById('service').value,
                        date: document.getElementById('date').value,
                        time: document.getElementById('time').value,
                        notes: document.getElementById('notes').value
                    };

                    // Loading UI
                    const originalText = btnText.textContent;
                    btnText.textContent = 'Procesando...';
                    submitBtn.disabled = true;

                    // Save to "DB" and send via Formspree
                    setTimeout(() => {
                        const success = window.NexoDB.saveAppointment(formData);

                        if (success) {
                            // Send to Formspree
                            fetch("https://formspree.io/f/mkobpzpe", { // Reemplaza con tu endpoint ID
                                method: "POST",
                                body: JSON.stringify(formData),
                                headers: {
                                    'Content-Type': 'application/json',
                                    'Accept': 'application/json'
                                }
                            }).then(response => {
                                if (response.ok) {
                                    // Show summary
                                    summaryDiv.innerHTML = `
                                        <ul>
                                            <li><strong>Fecha:</strong> ${formData.date}</li>
                                            <li><strong>Hora:</strong> ${formData.time}</li>
                                            <li><strong>Consultor:</strong> Senior Engineer</li>
                                        </ul>
                                        <p style="margin-top: 15px; color: #4CAF50;"><i class="fas fa-check"></i> Notificación enviada automáticamente.</p>
                                    `;
                                } else {
                                    summaryDiv.innerHTML = `<p style="color: #ffca28;">Agendado localmente, pero hubo un error al enviar la notificación. Por favor infórmanos por otro medio.</p>`;
                                }
                            }).catch(error => {
                                summaryDiv.innerHTML = `<p style="color: #ffca28;">Error de conexión al enviar la notificación.</p>`;
                            });

                            // Switch views
                            form.style.display = 'none';
                            successOverlay.style.display = 'block';

                            // Scroll to success message
                            successOverlay.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        } else {
                            alert('Hubo un error al guardar tu cita. Por favor intenta de nuevo.');
                            btnText.textContent = originalText;
                            submitBtn.disabled = false;
                        }
                    }, 1500);
                });
            }
        });
    </script>

    <style>
        .hero-mini {
            padding: 80px 0 40px;
            background: linear-gradient(to bottom, rgba(11, 15, 22, 0) 0%, rgba(108, 99, 255, 0.05) 100%);
        }

        .form-wrapper {
            max-width: 800px;
            margin: 0 auto;
            padding: 40px;
            position: relative;
            overflow: hidden;
        }

        .form-header {
            margin-bottom: 30px;
            text-align: center;
        }

        .form-header h3 {
            font-size: 1.8rem;
            color: var(--primary);
            margin-bottom: 10px;
        }

        .form-header p {
            color: var(--gray);
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .appointment-form .form-group {
            margin-bottom: 20px;
        }

        .appointment-form label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--light);
        }

        .appointment-form input,
        .appointment-form select,
        .appointment-form textarea {
            width: 100%;
            padding: 12px 15px;
            background: rgba(30, 35, 48, 0.5);
            border: 1px solid rgba(108, 99, 255, 0.2);
            border-radius: var(--border-radius);
            color: var(--white);
            font-family: inherit;
            transition: var(--transition);
        }

        .appointment-form input:focus,
        .appointment-form select:focus,
        .appointment-form textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(108, 99, 255, 0.1);
        }

        .form-actions {
            margin-top: 30px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }

        .btn-back {
            color: var(--gray);
            text-decoration: none;
            font-size: 0.9rem;
            transition: var(--transition);
        }

        .btn-back:hover {
            color: var(--primary);
        }

        /* Success Overlay */
        .success-overlay {
            padding: 40px 20px;
            text-align: center;
            animation: fadeIn 0.5s ease;
        }

        .success-icon {
            font-size: 4rem;
            color: #4CAF50;
            margin-bottom: 20px;
        }

        .success-content h3 {
            font-size: 2rem;
            margin-bottom: 15px;
            color: var(--white);
        }

        .success-content p {
            color: var(--gray);
            margin-bottom: 30px;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
        }

        .appointment-summary {
            background: rgba(108, 99, 255, 0.05);
            border: 1px dashed var(--primary);
            padding: 20px;
            border-radius: var(--border-radius);
            margin-bottom: 30px;
            text-align: left;
            display: inline-block;
            min-width: 300px;
        }

        .appointment-summary ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .appointment-summary li {
            margin-bottom: 8px;
            color: var(--light);
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }

            .form-wrapper {
                padding: 30px 20px;
            }
        }
    </style>
</body>

</html>